var freqSpan=document.querySelector("#freq"),body=document.querySelector("body"),ctx=new window.AudioContext,analyzerNode=ctx.createAnalyser(),audioData=new Float32Array(analyzerNode.fftSize),corrolatedSignal=new Float32Array(analyzerNode.fftSize),localMaxima=Array.from(Array(10),(function(){return 0})),start=function(){navigator.mediaDevices.getUserMedia({audio:!0}).then((function(a){ctx.createMediaStreamSource(a).connect(analyzerNode),setInterval((function(){analyzerNode.getFloatTimeDomainData(audioData);var a=getAutocorrolatedPitch();freqSpan.innerHTML="".concat(a.toFixed(2)),body.style.backgroundColor=a>8600?"red":"white"}),30)})).catch((function(a){alert("Error",a)}))},getAutocorrolatedPitch=function(){for(var a=0,e=0;e<analyzerNode.fftSize;e++){corrolatedSignal[e]=0;for(var o=0;o<analyzerNode.fftSize-e;o++)corrolatedSignal[e]+=audioData[o]*audioData[o+e];if(e>1&&corrolatedSignal[e-2]-corrolatedSignal[e-1]<0&&corrolatedSignal[e-1]-corrolatedSignal[e]>0&&(localMaxima[a]=e-1,++a>=localMaxima.length))break}for(var r=localMaxima[0],t=1;t<a;t++)r+=localMaxima[t]-localMaxima[t-1];return r/=a,ctx.sampleRate/r};
//# sourceMappingURL=index.abf75c18.js.map
